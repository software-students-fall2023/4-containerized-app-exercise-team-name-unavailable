let recorder,audioChunks=[];document.getElementById("startRecording").addEventListener("click",function(){navigator.mediaDevices.getUserMedia({audio:!0}).then(function(e){(recorder=new Recorder({encoderPath:"encoderWorker.min.js",stream:e})).start().then(()=>{console.log("Recording started"),document.getElementById("startRecording").disabled=!0,document.getElementById("stopRecording").disabled=!1})}).catch(function(e){console.error("Error accessing audio stream:",e)})}),document.getElementById("stopRecording").addEventListener("click",function(){recorder.stop().then(({blob:e})=>{window.audioBlob=e,console.log("Recording stopped"),document.getElementById("audioPlayback").src=URL.createObjectURL(e),document.getElementById("audioPlayback").style.display="block",document.getElementById("stopRecording").disabled=!0,document.getElementById("startRecording").disabled=!1})}),document.getElementById("recordingForm").addEventListener("submit",function(e){if(e.preventDefault(),!window.audioBlob){alert("No recording available. Please record something first.");return}let t=new FormData;t.append("audio",window.audioBlob,"audio.opus"),t.append("username",document.getElementById("username").value),t.append("name",document.getElementById("name").value),fetch("/upload",{method:"POST",body:t}).then(e=>{if(!e.ok)throw Error(`HTTP error! Status: ${e.status}`);return e.json()}).then(e=>{console.log("Success:",e),alert("Recording uploaded successfully.")}).catch(e=>{console.error("Error:",e),alert("Failed to upload recording.")})});